{"version":3,"names":["_processColor","_interopRequireDefault","require","_color","_transform","_reactNative","childrenAsString","children","length","join","extractOpacity","_ref","visible","opacity","pooledTransform","Transform","extractTransform","props","scaleX","scale","scaleY","transformTo","move","x","y","rotate","rotation","originX","originY","transform","xx","yx","xy","yy","toHex","color","intValues","red","green","blue","alpha","position","Platform","OS","splice","Math","round","hexValues","map","iv","sv","toString","extractShadow","_props$shadowOffset","_props$shadowOffset2","shadowColor","shadowOpacity","shadowRadius","shadowOffset","undefined","processColor","extractColor","Color","extractStrokeJoin","strokeJoin","extractStrokeCap","strokeCap","SOLID_COLOR","LINEAR_GRADIENT","RADIAL_GRADIENT","PATTERN","applyBoundingBoxToBrushData","brushData","type","width","height","extractBrush","colorOrBrush","_brush","_bb","c","extractAlignment","alignment","cachedFontObjectsFromString","fontFamilyPrefix","fontFamilySuffix","extractSingleFontFamily","fontFamilyString","split","replace","parseFontString","font","hasOwnProperty","regexp","match","exec","fontFamily","fontSize","isBold","isItalic","fontWeight","fontStyle","extractFont","newLine","extractFontAndLines","text","lines","insertColorIntoArray","targetArray","atIndex","insertColorsIntoArray","stops","i","offset","insertOffsetsIntoArray","multi","reverse","offsetNumber","offsetString","insertColorStopsIntoArray","lastIndex","insertDoubleColorStopsIntoArray"],"sources":["helpers.js"],"sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport processColor from 'react-native/Libraries/StyleSheet/processColor';\nimport Color from 'art/core/color';\nimport Transform from 'art/core/transform';\nimport {Platform} from 'react-native';\nimport type {\n  Alignment,\n  Brush,\n  ColorType,\n  Font,\n  GradientStops,\n  OpacityProps,\n  StrokeCap,\n  StrokeJoin,\n  TransformProps,\n  ShadowProps,\n} from './types';\n\nexport function childrenAsString(children?: string | Array<string>) {\n  if (!children) {\n    return '';\n  }\n  if (typeof children === 'string') {\n    return children;\n  }\n  if (children.length) {\n    return children.join('\\n');\n  }\n  return '';\n}\n\nexport function extractOpacity({visible, opacity}: OpacityProps) {\n  // TODO: visible === false should also have no hit detection\n  if (visible === false) {\n    return 0;\n  }\n  if (opacity == null) {\n    return 1;\n  }\n  return +opacity;\n}\n\nconst pooledTransform = new Transform();\n\nexport function extractTransform(props: TransformProps): Array<number> {\n  const scaleX =\n    props.scaleX != null ? props.scaleX : props.scale != null ? props.scale : 1;\n  const scaleY =\n    props.scaleY != null ? props.scaleY : props.scale != null ? props.scale : 1;\n\n  pooledTransform\n    .transformTo(1, 0, 0, 1, 0, 0)\n    .move(props.x || 0, props.y || 0)\n    .rotate(props.rotation || 0, props.originX, props.originY)\n    .scale(scaleX, scaleY);\n\n  if (props.transform != null) {\n    pooledTransform.transform(props.transform);\n  }\n\n  return [\n    pooledTransform.xx,\n    pooledTransform.yx,\n    pooledTransform.xy,\n    pooledTransform.yy,\n    pooledTransform.x,\n    pooledTransform.y,\n  ];\n}\n\nfunction toHex(color: Color) {\n  const intValues = [color.red, color.green, color.blue];\n  if (color.alpha < 1) {\n    // Android uses AARRGGBB ; iOS uses RRGGBBAA\n    // https://developer.android.com/reference/android/graphics/Color.html#parseColor(java.lang.String)\n    const position = Platform.OS === 'android' ? 0 : 3;\n    intValues.splice(position, 0, Math.round(color.alpha * 255));\n  }\n  const hexValues = intValues.map(iv => {\n    const sv = iv.toString(16);\n    return sv.length === 1 ? '0' + sv : sv;\n  });\n  return '#' + hexValues.join('');\n}\n\nexport function extractShadow(\n  props: ShadowProps,\n): Array<number | null | void> | void {\n  if (\n    !props.shadowColor &&\n    !props.shadowOpacity &&\n    !props.shadowRadius &&\n    !props.shadowOffset\n  ) {\n    return;\n  }\n\n  let opacity = props.shadowOpacity;\n\n  if (opacity === null || opacity === undefined) {\n    opacity = 1;\n  }\n\n  return [\n    processColor(props.shadowColor || 'black'),\n    opacity,\n    props.shadowRadius || 4,\n    props.shadowOffset?.x || 0,\n    props.shadowOffset?.y || 0,\n  ];\n}\n\nexport function extractColor(color?: ColorType) {\n  if (color == null) {\n    return null;\n  }\n  return toHex(new Color(color));\n}\n\nexport function extractStrokeJoin(strokeJoin?: StrokeJoin) {\n  switch (strokeJoin) {\n    case 'miter':\n      return 0;\n    case 'bevel':\n      return 2;\n    default:\n      return 1; // round\n  }\n}\n\nexport function extractStrokeCap(strokeCap?: StrokeCap) {\n  switch (strokeCap) {\n    case 'butt':\n      return 0;\n    case 'square':\n      return 2;\n    default:\n      return 1; // round\n  }\n}\n\nconst SOLID_COLOR = 0;\nconst LINEAR_GRADIENT = 1;\nconst RADIAL_GRADIENT = 2;\nconst PATTERN = 3;\n\n// TODO: Refactor and simplify applyBoundingBoxToBrushData and extractBrush\n\nfunction applyBoundingBoxToBrushData(\n  brushData: Array<number>,\n  props: {width: number, height: number},\n) {\n  const type = brushData[0];\n  const width = +props.width;\n  const height = +props.height;\n  if (type === LINEAR_GRADIENT) {\n    brushData[1] *= width;\n    brushData[2] *= height;\n    brushData[3] *= width;\n    brushData[4] *= height;\n  } else if (type === RADIAL_GRADIENT) {\n    brushData[1] *= width;\n    brushData[2] *= height;\n    brushData[3] *= width;\n    brushData[4] *= height;\n    brushData[5] *= width;\n    brushData[6] *= height;\n  } else if (type === PATTERN) {\n    // todo\n  }\n}\n\nexport function extractBrush(\n  colorOrBrush?: Brush | string,\n  props: {width: number, height: number},\n) {\n  if (colorOrBrush == null) {\n    return null;\n  }\n  if (colorOrBrush._brush) {\n    if (colorOrBrush._bb) {\n      // The legacy API for Gradients allow for the bounding box to be used\n      // as a convenience for specifying gradient positions. This should be\n      // deprecated. It's not properly implemented in canvas mode. ReactART\n      // doesn't handle update to the bounding box correctly. That's why we\n      // mutate this so that if it's reused, we reuse the same resolved box.\n\n      // $FlowFixMe\n      applyBoundingBoxToBrushData(colorOrBrush._brush, props);\n      // $FlowFixMe\n      colorOrBrush._bb = false;\n    }\n    return colorOrBrush._brush;\n  }\n  const c = new Color(colorOrBrush);\n  return [SOLID_COLOR, c.red / 255, c.green / 255, c.blue / 255, c.alpha];\n}\n\nexport function extractAlignment(alignment?: Alignment) {\n  switch (alignment) {\n    case 'right':\n      return 1;\n    case 'center':\n      return 2;\n    default:\n      return 0; // left\n  }\n}\n\nconst cachedFontObjectsFromString = {};\n\nconst fontFamilyPrefix = /^[\\s\"']*/;\nconst fontFamilySuffix = /[\\s\"']*$/;\n\nfunction extractSingleFontFamily(fontFamilyString: string) {\n  // ART on the web allows for multiple font-families to be specified.\n  // For compatibility, we extract the first font-family, hoping\n  // we'll get a match.\n  return fontFamilyString\n    .split(',')[0]\n    .replace(fontFamilyPrefix, '')\n    .replace(fontFamilySuffix, '');\n}\n\nfunction parseFontString(font: string) {\n  if (cachedFontObjectsFromString.hasOwnProperty(font)) {\n    return cachedFontObjectsFromString[font];\n  }\n  const regexp = /^\\s*((?:(?:normal|bold|italic)\\s+)*)(?:(\\d+(?:\\.\\d+)?)[ptexm\\%]*(?:\\s*\\/.*?)?\\s+)?\\s*\\\"?([^\\\"]*)/i;\n  const match = regexp.exec(font);\n  if (!match) {\n    return null;\n  }\n  const fontFamily = extractSingleFontFamily(match[3]);\n  const fontSize = +match[2] || 12;\n  const isBold = /bold/.exec(match[1]);\n  const isItalic = /italic/.exec(match[1]);\n  cachedFontObjectsFromString[font] = {\n    fontFamily: fontFamily,\n    fontSize: fontSize,\n    fontWeight: isBold ? 'bold' : 'normal',\n    fontStyle: isItalic ? 'italic' : 'normal',\n  };\n  return cachedFontObjectsFromString[font];\n}\n\nfunction extractFont(font?: string | Font) {\n  if (font == null) {\n    return null;\n  }\n  if (typeof font === 'string') {\n    return parseFontString(font);\n  }\n  const fontFamily = extractSingleFontFamily(font.fontFamily);\n  const fontSize = +font.fontSize || 12;\n  const fontWeight =\n    font.fontWeight != null ? font.fontWeight.toString() : '400';\n  return {\n    // Normalize\n    fontFamily: fontFamily,\n    fontSize: fontSize,\n    fontWeight: fontWeight,\n    fontStyle: font.fontStyle,\n  };\n}\n\nconst newLine = /\\n/g;\nexport function extractFontAndLines(font?: string | Font, text: string) {\n  return {font: extractFont(font), lines: text.split(newLine)};\n}\n\nfunction insertColorIntoArray(color: ColorType, targetArray, atIndex) {\n  const c = new Color(color);\n  targetArray[atIndex + 0] = c.red / 255;\n  targetArray[atIndex + 1] = c.green / 255;\n  targetArray[atIndex + 2] = c.blue / 255;\n  targetArray[atIndex + 3] = c.alpha;\n}\n\nfunction insertColorsIntoArray(\n  stops: GradientStops,\n  targetArray: Array<number>,\n  atIndex: number,\n) {\n  let i = 0;\n  if ('length' in stops) {\n    // $FlowFixMe: stops is Array here\n    while (i < stops.length) {\n      // $FlowFixMe: stops is Array here\n      insertColorIntoArray(stops[i], targetArray, atIndex + i * 4);\n      i++;\n    }\n  } else {\n    // $FlowFixMe stops is Object here\n    for (const offset in stops) {\n      insertColorIntoArray(stops[offset], targetArray, atIndex + i * 4);\n      i++;\n    }\n  }\n  return atIndex + i * 4;\n}\n\nfunction insertOffsetsIntoArray(\n  stops: GradientStops,\n  targetArray: Array<number>,\n  atIndex: number,\n  multi: number,\n  reverse: boolean,\n) {\n  let offsetNumber;\n  let i = 0;\n  if ('length' in stops) {\n    // $FlowFixMe: stops is Array here\n    while (i < stops.length) {\n      // $FlowFixMe: stops is Array here\n      offsetNumber = (i / (stops.length - 1)) * multi;\n      targetArray[atIndex + i] = reverse ? 1 - offsetNumber : offsetNumber;\n      i++;\n    }\n  } else {\n    // $FlowFixMe stops is Object here\n    for (const offsetString in stops) {\n      offsetNumber = +offsetString * multi;\n      targetArray[atIndex + i] = reverse ? 1 - offsetNumber : offsetNumber;\n      i++;\n    }\n  }\n  return atIndex + i;\n}\n\nexport function insertColorStopsIntoArray(\n  stops: GradientStops,\n  targetArray: Array<number>,\n  atIndex: number,\n) {\n  const lastIndex = insertColorsIntoArray(stops, targetArray, atIndex);\n  insertOffsetsIntoArray(stops, targetArray, lastIndex, 1, false);\n}\n\nexport function insertDoubleColorStopsIntoArray(\n  stops: GradientStops,\n  targetArray: Array<number>,\n  atIndex: number,\n) {\n  let lastIndex = insertColorsIntoArray(stops, targetArray, atIndex);\n  lastIndex = insertColorsIntoArray(stops, targetArray, lastIndex);\n  lastIndex = insertOffsetsIntoArray(stops, targetArray, lastIndex, 0.5, false);\n  insertOffsetsIntoArray(stops, targetArray, lastIndex, 0.5, true);\n}\n"],"mappings":"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"}